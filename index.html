<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Astrology Booking Form</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900">
  <div class="max-w-4xl mx-auto px-4 py-10">
    <h1 class="text-2xl font-semibold text-center mb-8">ðŸ”® Book Your Astrology Consultation</h1>

    <form action="https://YOUR_WEBHOOK_URL_HERE" method="POST" enctype="multipart/form-data" class="bg-white p-6 rounded-lg shadow-md space-y-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium mb-1">Full Name</label>
          <input type="text" name="Full Name" required class="w-full p-2 border rounded-md" placeholder="Your full name" />
        </div>

        <div>
          <label class="block text-sm font-medium mb-1">Phone Number</label>
          <input type="tel" name="Phone Number" required class="w-full p-2 border rounded-md" placeholder="For communications" />
        </div>

        <div>
          <label class="block text-sm font-medium mb-1">Email</label>
          <input type="email" name="Email" class="w-full p-2 border rounded-md" placeholder="your@email.com" />
        </div>

        <div>
          <label class="block text-sm font-medium mb-1">Date of Birth</label>
          <input type="date" name="Date of Birth" required class="w-full p-2 border rounded-md" />
        </div>

        <div>
          <label class="block text-sm font-medium mb-1">Birth Time (e.g. 04:30 PM)</label>
          <input type="text" name="Birth Time" required class="w-full p-2 border rounded-md" placeholder="hh:mm AM/PM" />
        </div>

        <div>
          <label class="block text-sm font-medium mb-1">Place of Birth</label>
          <input type="text" name="Place of Birth" required class="w-full p-2 border rounded-md" />
        </div>

        <div class="md:col-span-2">
          <label class="block text-sm font-medium mb-1">Select a Time Slot</label>
          <select name="Book Slot" id="slotDropdown" required class="w-full p-2 border rounded-md">
            <option value="">-- Loading available slots... --</option>
          </select>
        </div>

        <div class="md:col-span-2">
          <label class="block text-sm font-medium mb-1">Topics to Discuss</label>
          <textarea name="Topics to Discuss" required rows="4" placeholder="Briefly describe what you'd like to discuss..." class="w-full p-2 border rounded-md"></textarea>
        </div>

        <div class="md:col-span-2">
          <label class="block text-sm font-medium mb-1">Upload Payment Screenshot</label>
          <input type="file" name="Payment Screenshot" required accept="image/*" class="w-full"/>
          <p class="text-xs text-gray-500 mt-1">Accepted formats: PNG, JPG. Max size: 2MB.</p>
        </div>

        <!-- Hidden sessionID input -->
        <input type="hidden" name="SessionID" id="sessionIdInput" />

      </div>

      <div class="pt-4">
        <button type="submit" class="w-full bg-black text-white py-2 rounded-md hover:bg-gray-800">
          Submit Booking
        </button>
      </div>
    </form>
  </div>

  <script>
    // Autofill sessionID from URL param
    const urlParams = new URLSearchParams(window.location.search);
    const sessionId = urlParams.get("sessionID");
    if (sessionId) {
      document.getElementById("sessionIdInput").value = sessionId;
    }

    // Fetch available slots from Airtable (weâ€™ll wire this next)
    async function fetchSlots() {
      const dropdown = document.getElementById("slotDropdown");
      dropdown.innerHTML = `<option>Loading...</option>`;

      try {
        const res = await fetch("https://YOUR_PROXY_API_OR_BACKEND.com/slots");
        const data = await res.json();

        dropdown.innerHTML = `<option value="">-- Select a Slot --</option>`;
        data.forEach(slot => {
          const opt = document.createElement("option");
          opt.value = slot.label;
          opt.textContent = slot.label;
          dropdown.appendChild(opt);
        });
      } catch (err) {
        dropdown.innerHTML = `<option value="">Failed to load slots</option>`;
        console.error(err);
      }
    }

    fetchSlots();
  </script>
</body>
</html>
